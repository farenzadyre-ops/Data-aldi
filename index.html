<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Sheet Viewer</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input { padding: 8px; width: 100%; margin-bottom: 15px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    tr:nth-child(even) { background: #f9f9f9; }
  </style>
</head>
<body>
  <h1>ðŸ“Š Sheet Viewer</h1>
  <input type="text" id="search" placeholder="Cari data...">

  <table id="data-table"></table>

  <script>
    const sheetId = "17WawIQvd6_Y52ILvn-6Z-RBSxDpfFtYldnKhmvn7yw8";
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;

    let allData = [];

    // Ambil data dari Google Sheets
    fetch(url)
      .then(res => res.text())
      .then(text => {
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows.map(r => r.c.map(c => c ? c.v : ""));
        allData = rows;
        renderTable(allData);
      })
      .catch(err => {
        document.getElementById("data-table").innerHTML = "<tr><td>Gagal mengambil data. Pastikan sheet sudah publik.</td></tr>";
        console.error(err);
      });

    // Render tabel
    function renderTable(data) {
      const table = document.getElementById("data-table");
      table.innerHTML = "";
      data.forEach(row => {
        const tr = document.createElement("tr");
        row.forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          tr.appendChild(td);
        });
        table.appendChild(tr);
      });
    }

    // Filter pencarian
    document.getElementById("search").addEventListener("input", e => {
      const q = e.target.value.toLowerCase();
      const filtered = allData.filter(row =>
        row.some(cell => cell.toString().toLowerCase().includes(q))
      );
      renderTable(filtered);
    });
  </script>
</body>
</html>
