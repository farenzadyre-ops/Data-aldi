<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Bandingkan Excel (.xlsx) & Google Sheets</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #aaa; padding: 8px; }
    .same { background-color: #d4edda; }
    .diff { background-color: #f8d7da; }
  </style>
</head>
<body>
  <h2>Perbandingan: Excel vs Google Sheets</h2>
  <input type="file" id="excelFile" accept=".xlsx">
  <br><br>
  <input type="text" id="sheetUrl" size="80" placeholder="Link CSV Google Sheets...">
  <button onclick="compareData()">Bandingkan</button>

  <div id="result"></div>

  <script>
    let excelData = [];

    document.getElementById("excelFile").addEventListener("change", e => {
      let reader = new FileReader();
      reader.onload = ev => {
        let data = new Uint8Array(ev.target.result);
        let wb = XLSX.read(data, { type: 'array' });
        let ws = wb.Sheets[wb.SheetNames[0]];
        excelData = XLSX.utils.sheet_to_json(ws, { header: 1 });
      };
      reader.readAsArrayBuffer(e.target.files[0]);
    });

    async function compareData() {
      let url = document.getElementById("sheetUrl").value;
      try {
        let res = await fetch(url);
        let txt = await res.text();
        let sheetRows = txt.trim().split("\n").map(r => r.split(","));
        let maxRows = Math.max(excelData.length, sheetRows.length);
        let html = "<table><tr><th>Baris</th><th>Excel</th><th>Google Sheets</th></tr>";
        for (let i = 0; i < maxRows; i++) {
          let a = excelData[i] || [], b = sheetRows[i] || [];
          let same = a.join(",") === b.join(",");
          html += `<tr class="${same ? 'same' : 'diff'}">
                    <td>${i+1}</td>
                    <td>${a.join(", ")}</td>
                    <td>${b.join(", ")}</td>
                  </tr>`;
        }
        html += "</table>";
        document.getElementById("result").innerHTML = html;
      } catch (err) {
        document.getElementById("result").textContent = "Error fetch: " + err;
      }
    }
  </script>
</body>
</html>
